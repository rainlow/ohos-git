diff --git a/Makefile b/Makefile
index 1e31acc72e..d2d3c86c99 100644
--- a/Makefile
+++ b/Makefile
@@ -2763,14 +2763,14 @@ endif
 
 exec-cmd.sp exec-cmd.s exec-cmd.o: GIT-PREFIX
 exec-cmd.sp exec-cmd.s exec-cmd.o: EXTRA_CPPFLAGS = \
-	'-DGIT_EXEC_PATH="$(gitexecdir_SQ)"' \
+	'-DGIT_EXEC_PATH="$(gitexecdir_relative_SQ)"' \
 	'-DGIT_LOCALE_PATH="$(localedir_relative_SQ)"' \
 	'-DBINDIR="$(bindir_relative_SQ)"' \
 	'-DFALLBACK_RUNTIME_PREFIX="$(prefix_SQ)"'
 
 setup.sp setup.s setup.o: GIT-PREFIX
 setup.sp setup.s setup.o: EXTRA_CPPFLAGS = \
-	-DDEFAULT_GIT_TEMPLATE_DIR='"$(template_dir_SQ)"'
+	-DDEFAULT_GIT_TEMPLATE_DIR='"$(template_dir_relative_SQ)"'
 
 config.sp config.s config.o: GIT-PREFIX
 config.sp config.s config.o: EXTRA_CPPFLAGS = \
diff --git a/git-instaweb.sh b/git-instaweb.sh
index 994431c887..18895604c5 100755
--- a/git-instaweb.sh
+++ b/git-instaweb.sh
@@ -39,7 +39,7 @@ conf="$GIT_DIR/gitweb/httpd.conf"
 test -z "$httpd" && httpd='lighttpd -f'
 
 # Default is @@GITWEBDIR@@
-test -z "$root" && root='@@GITWEBDIR@@'
+test -z "$root" && root=$(realpath $(dirname $0)/../../share/gitweb)
 
 # any untaken local port will do...
 test -z "$port" && port=1234
